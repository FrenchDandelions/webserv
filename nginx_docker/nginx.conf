# Nginx configuration file

worker_processes auto;

events {
    worker_connections 1024;
}

http {
    include mime.types;
    default_type application/octet-stream;

    # Log configuration
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;


server {
    listen 4247;
    server_name localhost;

    # Serve static files (e.g., HTML files) from the specified directory
    location / {
        root /usr/share/nginx/html;  # Directory where your HTML file is located
        try_files $uri $uri/ =404;   # Serve the file or return 404 if not found
    }

    # Proxy pass to backend server for file uploads
    location /upload {
        proxy_pass http://localhost:3000;  # Backend server handling uploads
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
    # Server configuration
#     server {
#         listen 4247;
#         server_name localhost;
#
# location / {
#             root /usr/share/nginx/html; # Directory where the HTML file is located
#             index uploadTest.html;
#         }
#         # Location for handling multipart chunked requests
#         location /upload {
#             # Proxy requests to the backend server that handles multipart requests
#             proxy_pass http://localhost:3000;  # Change this to your backend server address
#             proxy_set_header Host $host;
#             proxy_set_header X-Real-IP $remote_addr;
#             proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#             proxy_set_header X-Forwarded-Proto $scheme;
#
#             # Optional: Increase buffer and timeout settings for large requests
#             client_max_body_size 100M;  # Adjust as needed for large files
#             client_body_buffer_size 128k;
#             proxy_read_timeout 120s;
#         }
    # }
}

